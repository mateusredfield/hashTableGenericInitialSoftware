<html>

<head>
	<title>Buscas</title>

	<meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
  
    <link href="/resources/css/bootstrap.min.css" rel="stylesheet">
    <link href="/resources/support/topMenuConstructor.css" rel="stylesheet">

    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.0/jquery.min.js"></script>
    <script src="https://code.jquery.com/jquery-1.10.2.js"></script>
    <script src="/resources/js/bootstrap.min.js"></script>
    <script src="/resources/support/topMenuConstructor.js"></script>
    <script src="/resources/support/commonMethods.js"></script>

    <!-- Validation form-->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.inputmask/3.3.3/jquery.inputmask.bundle.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-validate/1.16.0/jquery.validate.js"></script>

</head>

<body>

<p style="border:solid 1px black; 
		  background-color:white; 
		  margin-left:10px; 
		  margin-right:10px;
		  margin-top:10px;
		  text-align:center;
		  font-size: 24px;">
		  <b>Buscas</b>
</p>

<!-- Busca por trabalhadores internos e div com hide-->
<div class= "container-fluid" id ="buscaTrabalhadoresContanier" style="border:solid 1px black; margin:10px 10px 10px 10px">
	<form id="formBuscaTrabalhadoresInternos" action="javascript:buscaPorTrabalhadores()">
	<fieldset>
	<div class="paragrafo1" style="margin:0px 0 0 10px">
		<h3><b>Buscas por Trabalhadores Internos</b></h3>
			<div class="row" style="margin-bottom:15px; margin-top:20px;">
				<div class="col-md-6">
					<span style="float:left;margin-top:1px"><b>CPF:</b></span><!-- Colocado em pilha pelo float-->
					<input id="cpfBusca" name="cpfBusca" type="text" pattern="[0-9][0-9][0-9].[0-9][0-9][0-9].[0-9][0-9][0-9]-[0-9][0-9]" required placeholder=" XXX.XXX.XXX-X" style="width:60%; float:left;position: relative !important; z-index: 0 !important;">
				</div>
			</div>
	</div>
	<div class="row" style="margin-bottom:15px;">
			<div class="col-md-6">
				<div style="width:70%; float:left;">
					<input class="center-block" type="submit" value="Enviar" onClick="">
				</div>
			</div>
	</div>
	</fieldset>
	</form>
</div>
<!-- Campo hide/show pelo javascript-->
<div class= "container-fluid" id="resultadoBuscaTrabalhadoresContanier" style="border:solid 1px black; margin:10px 10px 10px 10px">
	<div class="paragrafo1" style="margin:0px 0 0 10px">
		<!-- <h3><b>Resultados</b></h3> -->
		<div class="row"> <!-- style="margin-bottom:15px; margin-top:20px;"> -->
			<div class="col-md-6">
				<div id="resultadoBuscaTrabalhadoresDiv" style="margin:0px 0 20px 0px">
				</div>
			</div>
		</div>
	</div>
</div>

<!--Modulo Trabalhadores Externos-->
<div class= "container-fluid" id ="buscaTrabalhadoresExternosContanier"style="border:solid 1px black; margin:10px 10px 10px 10px">
	<form id="formBuscaTrabalhadoresExternos" action="javascript:buscaPorTrabalhadoresExternos()">
		<fieldset>
			<div class="paragrafo1" style="margin:0px 0 0 10px">
				<h3><b>Buscas por Trabalhadores Externos</b></h3>
				<div class="row" style="margin-bottom:15px; margin-top:20px;">
					<div class="col-md-6">
						<span style="float:left;margin-top:1px"><b>CPF:</b></span><!-- Colocado em pilha pelo float-->
						<input id="cpfBuscaTrabalhadoresExternos" type="text" pattern="[0-9][0-9][0-9].[0-9][0-9][0-9].[0-9][0-9][0-9]-[0-9][0-9]" required placeholder=" XXX.XXX.XXX-X" style="width:60%; float:left;">
					</div>
				</div>
			</div>
	<div class="row" style="margin-bottom:15px;">
			<div class="col-md-6">
				<div style="width:70%; float:left;">
					<input class="center-block" type="submit" value="Enviar" onClick="">
				</div>
			</div>
	</div>
        </fieldset>
	</form>
</div>
<!-- Campo hide/show pelo javascript-->
<div class= "container-fluid" id="resultadoBuscaTrabalhadoresExternosContanier" style="border:solid 1px black; margin:10px 10px 10px 10px">
	<div class="paragrafo1" style="margin:0px 0 0 10px">
		<div class="row"> <!-- style="margin-bottom:15px; margin-top:20px;"> -->
			<div class="col-md-6">
				<div id="resultadoBuscaTrabalhadoresExternosDiv" style="margin:0px 0 20px 0px">
				</div>
			</div>
		</div>
	</div>
</div>
<!--Modulo Empresas Clientes-->
<div class= "container-fluid" id ="buscaEmpresasClientesContanier" style="border:solid 1px black; margin:10px 10px 10px 10px">
	<form id="formBuscaEmpresasClientes" action="javascript:buscaPorEmpresasClientes()">
		<fieldset>
			<div class="paragrafo1" style="margin:0px 0 0 10px">
				<h3><b>Buscas por Empresas Clientes</b></h3>
				<div class="row" style="margin-bottom:15px; margin-top:20px;">
					<div class="col-md-6">
						<span style="float:left;margin-top:1px"><b>CNPJ/CGC:</b></span><!-- Colocado em pilha pelo float-->
						<input id="cnpjBuscaEmpresasClientes" type="text" pattern="[0-9]{8}/[0-9]{4}-[0-9]{2}" required placeholder=" C.N.P.J/C.G.C" style="width:60%; float:left;">
					</div>
				</div>
			</div>
			<div class="row" style="margin-bottom:15px;">
					<div class="col-md-6">
						<div style="width:70%; float:left;">
							<input class="center-block" type="submit" value="Enviar" onClick="">
						</div>
					</div>
			</div>
		</fieldset>
	</form>
</div>
<!-- Campo hide/show pelo javascript-->
<div class= "container-fluid" id="resultadoBuscaEmpresasClientesContanier" style="border:solid 1px black; margin:10px 10px 10px 10px">
	<div class="paragrafo1" style="margin:0px 0 0 10px">
		<div class="row"> <!-- style="margin-bottom:15px; margin-top:20px;"> -->
			<div class="col-md-6">
				<div id="resultadoBuscaEmpresasClientesDiv" style="margin:0px 0 20px 0px">
				</div>
			</div>
		</div>
	</div>
</div>

<!-- Espacamento-->
<br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br>

</body>
</html>

<script type="text/javascript">

	Inputmask.extendDefinitions({
  	'a': {
    validator: "[a-zA-Z ]",
    cardinality: 1,
  	}
	});

	$("#cpfBusca").inputmask("999.999.999-99");
	$("#cpfBuscaTrabalhadoresExternos").inputmask("999.999.999-99");
	$("#cnpjBuscaEmpresasClientes").inputmask("9{8}/9{4}-9{2}");

	//Inicializacoes
	$(document).ready(function() {

    	var tipoDeBusca = getUrlVars().tipoDeBusca;
    	$('#buscaTrabalhadoresContanier').hide();
    	$('#resultadoBuscaTrabalhadoresContanier').hide();
    	$('#buscaTrabalhadoresExternosContanier').hide();
    	$('#resultadoBuscaTrabalhadoresExternosContanier').hide();
    	$('#buscaEmpresasClientesContanier').hide();
    	$('#resultadoBuscaEmpresasClientesContanier').hide();
    	switch(parseInt(tipoDeBusca)) {
    		case 1:
        	$('#buscaTrabalhadoresContanier').show();
        break;
    	case 2:
        	$('#buscaTrabalhadoresExternosContanier').show();
        break;
        case 3:
        	$('#buscaEmpresasClientesContanier').show();
        	break;
    	default:
        	$('body').append("<h3>Escolha um tipo de busca</h3>");
		}
	});

	function buscaPorTrabalhadores(){
		var cpf = $('#cpfBusca').val();
		$.post('BuscaPorTrabalhadores.php',{cpf: cpf},function(data){
			var dados = jQuery.parseJSON(data);
 			var text = "";
 			//O if escolhe o que vai no texto - se tem dados coloca, se nao nao, mas talvez nao precise de for se
 			//soh tiver um trabalhador com o dado cpf
 			if(dados[0] !== "No Elements"){
	 			for(var i = 0; i < dados.length; i++){
	 				text = text + 'Nome:'+dados[i].Nome+'<br>dataDeNasc:'+dados[i].DataDeNasc+'<br>CPF:'+dados[i].CPF+'<br>PIS:'+dados[i].PIS+'<br>Profissão de Registro:'+dados[i].ProfissaoDeRegistro+'<br>Endereço:'+dados[i].Endereco+'<br>Telefone:'+dados[i].Telefone+'<br>Email:'+dados[i].Email+'<br>Data de Registro:'+dados[i].DataDeRegistro;
	 			}
	 		}else{
	 			text = "<h4>Não Foram encontrados trabalhadores com esse CPF</h4>"
	 		}
	 		$('#resultadoBuscaTrabalhadoresDiv').html(text);
	 		$('#resultadoBuscaTrabalhadoresContanier').show();
	 		//Parei Aqui - fazer as outras duas buscas/ ou mascaras, e tudo isso pros otros 
	 		//dois casos.
 		})
	}
	function buscaPorTrabalhadoresExternos(){
		var cpf = $('#cpfBuscaTrabalhadoresExternos').val();
		$.post('BuscaPorTrabalhadoresExternos.php',{cpf: cpf},function(data){
			var dados = jQuery.parseJSON(data);
 			var text = "";
 			//O if escolhe o que vai no texto - se tem dados coloca, se nao nao, mas talvez nao precise de for se
 			//soh tiver um trabalhador com o dado cpf
 			if(dados[0] !== "No Elements"){
	 			for(var i = 0; i < dados.length; i++){
	 				text = text + '<br><p>Nome:'+dados[i].nome+'<br>dataDeNasc:'+dados[i].dataDeNascimento+'<br>CPF:'+dados[i].cpf+'<br>PIS:'+dados[i].pis+'<br>deficiência:'+dados[i].deficiencia+'<br>nome do pai:'+dados[i].nomeDoPai+'<br>nome da mãe:'+dados[i].nomeDaMae+'<br>RG:'+dados[i].rg+'<br>CTPS:'+dados[i].ctps+'<br>Telfone:'+dados[i].telefoneDoProfissional+'<br>Email:'+dados[i].emailDoProfissional+'</p>';
	 			}
	 		}else{
	 			text = "<h4>Não Foram encontrados trabalhadores com esse CPF</h4>"
	 		}
	 		$('#resultadoBuscaTrabalhadoresExternosDiv').html(text);
	 		$('#resultadoBuscaTrabalhadoresExternosContanier').show();
 		})
	}
	function buscaPorEmpresasClientes(){
		var cnpj = $('#cnpjBuscaEmpresasClientes').val();//pode ser CNG e por isso tem isso no sql tambem
		$.post('BuscaPorEmpresasClientes.php',{cnpj: cnpj},function(data){
			var dados = jQuery.parseJSON(data);
 			var text = "";
 			//O if escolhe o que vai no texto - se tem dados coloca, se nao nao, mas talvez nao precise de for se
 			//soh tiver um trabalhador com o dado cpf
 			if(dados[0] !== "No Elements"){
	 			for(var i = 0; i < dados.length; i++){
	 				text = text + '<br><p>Razao Social:'+dados[i].razaoSocial+'<br>Endereço:'+dados[i].endereco+'<br>Ramo de Atividade:'+dados[i].ramoDeAtividade+'<br>CNAE:'+dados[i].cnae+'<br>Grau de Risco:'+dados[i].grauDeRisco+'<br>Nro de Trabalhadores:'+dados[i].nroDeTrabalhadores+'<br>BR PDH:'+dados[i].brPdh+'<br>CNPJ/CGC:'+dados[i].cnpjCgc+'<br>Horário de Trabalho:'+dados[i].horarioDeTrabalho+'<br>Responsável Legal:'+dados[i].responsavelLegal+'<br>Pis Pasep Ci:'+dados[i].pisPasepCi+'<br>Telefone:'+dados[i].telefone+'<br>Email:'+dados[i].email+'<br>Data do Cadastro:'+dados[i].dataDoCadastro+'<br>Data do Contrato:'+dados[i].dataDoContrato+'<br>Tipo de Cobrança:'+dados[i].tipoDeCobranca+'</p>';
	 			}
	 		}else{
	 			text = "<h4>Não Foram encontradas Empresas com esse CNPJ/CNAE</h4>"
	 		}
	 		$('#resultadoBuscaEmpresasClientesDiv').html(text);
	 		$('#resultadoBuscaEmpresasClientesContanier').show();
 		})
	}

</script>





